<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: paper_table_builder.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: paper_table_builder.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file Builds the table for displaying the current 
 * @author Josiah Coad and Filip Gnesin
*/

 /**
    * Enum for Button Decision values.
    * @readonly
    * @enum {string}
*/
const Decision = {
    INCLUDE: "include",
    MAYBE: "maybe",
    EXCLUDE: "exclude"
};

/**
    * Expand a table row and apply the selection classes. Collapse and deselect all other rows.
*/
function expandAccordian(thisObj){
    $("tbody").children().removeClass('selected');
    $("tbody").children().addClass('unselected');
    $("tbody").find(".collapse").collapse('hide');
    thisObj.removeClass('unselected');
    thisObj.addClass('selected');
    thisObj.find(".collapse").collapse('show');
}

/**
    * Change the decision button for the '.selected' row/paper to the new_decision.
    * @param {string} new_decision - One of the following ["include", "exclude", "maybe"]
*/
function changeDecisionButton(new_decision){
    var CLASSES_COMMON = "btn btn-block decisionbutt"
    var CLASSES_FOR_INCLUDE = "btn-success include"
    var CLASSES_FOR_MAYBE = "btn btn-info maybe"
    var CLASSES_FOR_EXCLUDE = "btn-danger exclude"
    
    switch(new_decision){
        case Decision.INCLUDE:
            $("tbody .selected").find(".decisionbutt").removeClass().addClass(CLASSES_COMMON + " " + CLASSES_FOR_INCLUDE);
            break;
        case Decision.MAYBE:
            $("tbody .selected").find(".decisionbutt").removeClass().addClass(CLASSES_COMMON + " " + CLASSES_FOR_MAYBE);
            break;
        case Decision.EXCLUDE:
            $("tbody .selected").find(".decisionbutt").removeClass().addClass(CLASSES_COMMON + " " + CLASSES_FOR_EXCLUDE);
            break;
        default:
            console.log("Tyring to set the decision button to an invalid new_decision.")
            return;
    }
}


/**
  * Builds a column of 4 buttons, the one on top (non-operational) displays the current decision. The 3 buttons below it give the options for a new decision. 
  * @returns {Object} A column element populated with the four buttons.
*/
function getDecisionButtonsColumn(){
    // create a new column for the buttons 
    var $td_buttons = $("&lt;td>", {class: "td_buttons"})

    // create a decision button that will be non-operational (no action on click), just shows the current decision
    var $decisionbutton = $("&lt;button>", {id: "decisionbutton", type:"button", class:"btn btn-outline-secondary btn-block undecide decisionbutt"})

    // create 3 operational buttons for choosing a new decision
    var $include_button = $("&lt;button>", {type: "button", class:"btn btn-outline-success btn-block button-adjust include"}).click(function() {changeDecisionButton("include")})
    var $maybe_button = $("&lt;button>", {type: "button", class:"btn btn-outline-info btn-block button-adjust maybe"}).click(function() {changeDecisionButton("maybe")})
    var $exclude_button = $("&lt;button>", {type: "button", class:"btn btn-outline-danger btn-block button-adjust exclude"}).click( function() {changeDecisionButton("exclude")})
    
    // create a new div and add the buttons to the div
    var $optionbuttonsdiv = $("&lt;div>", {id:"buttons", class:"collapse collapsingItem"}).append($include_button, $maybe_button, $exclude_button)

    // add the div to the column
    $td_buttons.append($decisionbutton, $optionbuttonsdiv)

    return $td_buttons
}


/**
  * Builds a new table row containing the title, abstract and buttons for a paper.
  * @param {Object[]} allpapers - A list of papers for screening.
  * @param {int} i - The index of the paper (in allpapers) to build a new table row for.
  * @returns {Object} The table row representing the paper in allpapers at index i.
*/
function getNewTableRow(allpapers, i){
    // build the table row and add the stars to the first column in the row
    var $tr = $("&lt;tr>", {id: "foo", "class": "unselected", "data-toggle": 'collapse', "data-index": i, "data-target": ".collapsingItem" + i});
    var $stars = $("&lt;div>", {class: "rateYo"}).rateYo({ rating: allpapers[i]["rating"] }).rateYo("option", "starWidth", "20px");
    var $td_rating = $("&lt;td>").append($stars);

    // build the title and abstract and add them to the second column in the row
    var $td_title_abstract = $("&lt;td>", {id: "table-heading-abstract"})

    // title and abstract have to be built by string concatenation because the text color highlighting will not be tampered with this way 
    // (as opposed to trying to build the title and abstract using jquery functions)
    var td_title = "&lt;h5>" + allpapers[i]['title'] + "&lt;/h5>";
    var div_abstract = "&lt;div class='collapse collapsingItem'>" + allpapers[i]['abstract'] + "&lt;/div>"
    $td_title_abstract.append(td_title, div_abstract)

    // build the buttons for the decision in the third column in the row
    var $td_buttons = getDecisionButtonsColumn()

    // add all columns to the row
    $tr.append($td_rating, $td_title_abstract, $td_buttons) 

    // add a click function to the table row so that it will expand (and the others collapse) when clicked
    $tr.click( function() { expandAccordian($(this)) });

    // return the row
    return $tr
}

/**

*/
function displayPapers(allpapers) {

    num_display_papers = Math.min(5, allpapers.length)

    for (var i=0; i&lt;num_display_papers; i++) {
        $("table tbody").append(getNewTableRow(allpapers, i));
    }
};</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#changeDecisionButton">changeDecisionButton</a></li><li><a href="global.html#Decision">Decision</a></li><li><a href="global.html#displayPapers">displayPapers</a></li><li><a href="global.html#expandAccordian">expandAccordian</a></li><li><a href="global.html#getDecisionButtonsColumn">getDecisionButtonsColumn</a></li><li><a href="global.html#getNewTableRow">getNewTableRow</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Thu Dec 07 2017 17:23:31 GMT+0200 (EET)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
